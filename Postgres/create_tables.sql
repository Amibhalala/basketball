 CREATE TABLE player (
     player_id INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
     name text NOT NULL,
     height int NULL,
     width int NULL,
     college text,
     born int NULL,
     birth_city text,
     birth_state text,
     year_start int,
     year_end  int,
     position  text,
     weight int,
     birth_date TIMESTAMPTZ
 );
COPY player(player_id ,name,height,width,college,born,birth_city,birth_state) FROM '/tmp/Players.csv' (format csv,FORCE_NULL(height),DELIMITER ',',HEADER);

CREATE TABLE season_stats (
    season_stats_id INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    year int,
    name text,
    position text,
    age int  ,
    team text  ,
    games int  ,
    games_started int ,
    minutes_played int,
    player_efficiency_rating numeric(5,1),
    true_shooting   NUMERIC(5,3),
    three_point_attempt_rate   NUMERIC(5,3),
    free_throw_rate    NUMERIC(5,3),
    offensive_rebound_percentage    NUMERIC(4,1),
    defensive_rebound_percentage    NUMERIC(4,1),
    total_rebound_percentage    NUMERIC(4,1),
    assist_percentage    NUMERIC(4,1),
    steal_percentage    NUMERIC(4,1),
    block_percentage    NUMERIC(4,1),
    turnover_percentage    NUMERIC(4,1),
    usage_percentage    NUMERIC(4,1),
    blanl  text,
    offensive_win_shares    NUMERIC(4,1),
    defensive_win_shares    NUMERIC(4,1),
    win_shares     NUMERIC(4,1),
    win_shares_48   NUMERIC(6,3),
    blank2 text,
    offensive_box_plus_minus   NUMERIC(5,1),
    defensive_box_plus_minus    NUMERIC(5,1),
    box_plus_minus    NUMERIC(5,1),
    value_over_replacement   NUMERIC(4,1),
    field_goals     int ,
    field_goal_attempts    int ,
    field_goal_percentage    NUMERIC(5,3),
    three_point_field_goals     int ,
    three_point_field_goal_attempts    int ,
    three_point_field_goal_percentage     NUMERIC(5,3),
    two_point_field_goals     int ,
    two_point_field_goal_attempts    int ,
    two_point_field_goal_percentage     NUMERIC(5,3),
    effective_field_goal_percentage    NUMERIC(5,3),
    free_throws     int ,
    free_throw_attempts    int ,
    free_throw_percentage     NUMERIC(5,3),
    offensive_rebounds    int ,
    defensive_rebounds    int ,
    total_rebounds    int ,
    assists    int ,
    steals    int ,
    blocks    int ,
    turnovers    int ,
    personal_fouls     int ,
    points    int 
 );

COPY season_stats(    season_stats_id,
    year,
    name,
    position,
    age ,
    team,
    games ,
    games_started,
    minutes_played ,
    player_efficiency_rating,
    true_shooting  ,
    three_point_attempt_rate  ,
    free_throw_rate,
    offensive_rebound_percentage,
    defensive_rebound_percentage,
    total_rebound_percentage,
    assist_percentage,
    steal_percentage,
    block_percentage,
    turnover_percentage,
    usage_percentage,
    blanl,
    offensive_win_shares,
    defensive_win_shares,
    win_shares,
    win_shares_48  ,
    blank2,
    offensive_box_plus_minus  ,
    defensive_box_plus_minus,
    box_plus_minus,
    value_over_replacement  ,
    field_goals  ,
    field_goal_attempts ,
    field_goal_percentage,
    three_point_field_goals  ,
    three_point_field_goal_attempts ,
    three_point_field_goal_percentage ,
    two_point_field_goals  ,
    two_point_field_goal_attempts ,
    two_point_field_goal_percentage ,
    effective_field_goal_percentage,
    free_throws  ,
    free_throw_attempts ,
    free_throw_percentage ,
    offensive_rebounds ,
    defensive_rebounds ,
    total_rebounds ,
    assists ,
    steals ,
    blocks ,
    turnovers ,
    personal_fouls  ,
    points) FROM '/tmp/Seasons_Stats.csv' (format csv,FORCE_NULL(year),DELIMITER ',',HEADER);

CREATE TABLE player_data (
    player_data_id INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name text NOT NULL,
    year_start int,
    year_end   int,
    position  text,
    height text,
    weight     int, 
    birth_date TIMESTAMPTZ,
    college    text
 );

COPY player_data(name,year_start,year_end,position,height,weight,birth_date,college) FROM '/tmp/player_data.csv' (format csv,FORCE_NULL(year_start),DELIMITER ',',HEADER);

update player 
set year_start=player_data.year_start ,
year_end=player_data.year_end,
position=player_data.position,
weight=player_data.weight,
birth_date=player_data.birth_date,
college=player_data.college
from player_data  where player.name = player_data.name;




